write.table(round(abs(tmn.pnobio2), 2), "abstmn.pnobio13.xls", row.names = T, sep = "\t")
write.table(round(abs(tmn.pnobio2), 2), "pnobio2.xls", row.names = T, sep = "\t")
#bio14
climvar <- paste(getwd(),'/hotlayers/bio3.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio3 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio3, legend.pos= NULL)
write.table(round(abs(tmn.pnobio3), 2), "pnobio3.xls", row.names = T, sep = "\t")
#bio8
climvar <- paste(getwd(),'/hotlayers/bio8.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio8 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio8,legend.pos= NULL)
write.table(round(abs(tmn.pnobio8), 2), "pnobio8.xls", row.names = T, sep = "\t")
#bio9
climvar <- paste(getwd(),'/hotlayers/bio9.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio9 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio9, legend.pos= NULL)
write.table(round(abs(tmn.pnobio9), 2), "pnobio9.xls", row.names = T, sep = "\t")
#bio13
climvar <- paste(getwd(),'/hotlayers/bio13.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio13 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio13,legend.pos= NULL)
write.table(round(abs(tmn.pnobio13), 2), "pnobio13.xls", row.names = T, sep = "\t")
climvar <- paste(getwd(),'/hotlayers/bio14.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio14 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio15,legend.pos= NULL)
tmn.pnobio15 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio15,legend.pos= NULL)
write.table(round(abs(tmn.pnobio15), 2), "pnobio15.xls", row.names = T, sep = "\t")
#bio18
climvar <- paste(getwd(),'/hotlayers/bio18.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio18 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio18,legend.pos= NULL)
write.table(round(abs(tmn.pnobio18), 2), "pnobio18.xls", row.names = T, sep = "\t")
#bio19
climvar <- paste(getwd(),'/hotlayers/bio19.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio19 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
caespitosa<-raster("caespitosa_median.asc")
plotPNO(tmn.pnobio19,legend.pos= NULL)
write.table(round(abs(tmn.pnobio19), 2), "pnobio19.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio13))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio13))), 2), "overlapbio13.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio14))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio14))), 2), "overlapbio14.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio15))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio15))), 2), "overlapbio15.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio18))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio18))), 2), "overlapbio18.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio19))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio19))), 2), "overlapbio19.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio2))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio2))), 2), "overlapbio2.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio3))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio3))), 2), "overlapbio3.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio8))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio8))), 2), "overlapbio8.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio9))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio9))), 2), "overlapbio9.xls", row.names = T, sep = "\t")
setwd("/Volumes/PAT/Directory/Raster-median")
caespitosa<-raster("caespitosa_median.asc")
list_specimes <- list(abietina,alata,albiflora,aloifolia,auriculata,barbata,brevifolia,breviscapa,burlemarxii,caespitosa,candida,caputardeae,caruncularis,caudata,ciliata,compacta,crinita,cryptantha,dasypus,declinans,epidendroides,froesii,furcata,geotegens,gigantea,giulietiiae,glabra,glauca,graminea.graomogolensis,hatschbachii,hemisphaerica ,hirsuta,intermedia,jolyi,marcescens,maxillarioides,metzgerae,minima,nanuzae,nivea,obtecta,ornata,patens,peripherica,plicata,resinosa,seubertiana,spiralis,stenocarpa,stipitata,strangii,subscabra,taxifolia,tragacantha,tubiflora,variabilis,variegata)
list_specimes <- list(abietina,alata,albiflora,aloifolia,auriculata,barbata,brevifolia,breviscapa,burlemarxii,caespitosa,candida,caputardeae,caruncularis,caudata,ciliata,compacta,crinita,cryptantha,dasypus,declinans,epidendroides,froesii,furcata,geotegens,gigantea,giulietiiae,glabra,glauca,graminea,graomogolensis,hatschbachii,hemisphaerica ,hirsuta,intermedia,jolyi,marcescens,maxillarioides,metzgerae,minima,nanuzae,nivea,obtecta,ornata,patens,peripherica,plicata,resinosa,seubertiana,spiralis,stenocarpa,stipitata,strangii,subscabra,taxifolia,tragacantha,tubiflora,variabilis,variegata)
seubertiana <-raster("seubertiana _median.asc")
seubertiana <-raster("seubertiana_median.asc")
list_specimes <- list(abietina,alata,albiflora,aloifolia,auriculata,barbata,brevifolia,breviscapa,burlemarxii,caespitosa,candida,caputardeae,caruncularis,caudata,ciliata,compacta,crinita,cryptantha,dasypus,declinans,epidendroides,froesii,furcata,geotegens,gigantea,giulietiiae,glabra,glauca,graminea,graomogolensis,hatschbachii,hemisphaerica ,hirsuta,intermedia,jolyi,marcescens,maxillarioides,metzgerae,minima,nanuzae,nivea,obtecta,ornata,patens,peripherica,plicata,resinosa,seubertiana,spiralis,stenocarpa,stipitata,strangii,subscabra,taxifolia,tragacantha,tubiflora,variabilis,variegata)
i<-1
j <- 0
analise <- 0
for (specie in list_specimes){
for (specie2 in list_specimes){
analise[i]<-nicheOverlap(specie,specie2, stat='D', mask=F, checkNegatives=F)
i<-i+1
}
}
i<-1
j <- 0
analise <- 0
for (specie in list_specimes){
for (specie2 in list_specimes){
analise[i]<-nicheOverlap(specie,specie2, stat='D', mask=F, checkNegatives=F)
i<-i+1
}
}
i<-1
j <- 0
analise <- 0
for (specie in list_specimes){
for (specie2 in list_specimes){
analise[i]<-nicheOverlap(specie,specie2, stat='D', mask=F, checkNegatives=F)
i<-i+1
}
}
#index I
i<-1
j <- 0
analise <- 0
for (specie in list_specimes){
for (specie2 in list_specimes){
analise[i]<-nicheOverlap(specie,specie2, stat='I', mask=F, checkNegatives=F)
i<-i+1
}
}
list_specimes <- list(abietina,alata,albiflora,aloifolia)
i<-1
j <- 0
analise <- 0
for (specie in list_specimes){
for (specie2 in list_specimes){
analise[i]<-nicheOverlap(specie,specie2, stat='D', mask=F, checkNegatives=F)
i<-i+1
}
}
matriz <- matrix(analise,nrow = 4,ncol = 4)
matriz <- matrix(analise,nrow = 4,ncol = 4)
matriz
list_specimes <- list(abietina,alata,albiflora,aloifolia,auriculata,barbata,brevifolia,breviscapa,burlemarxii,caespitosa,candida,caputardeae,caruncularis,caudata,ciliata,compacta,crinita,cryptantha,dasypus,declinans,epidendroides,froesii,furcata,geotegens,gigantea,giulietiiae,glabra,glauca,graminea,graomogolensis,hatschbachii,hemisphaerica ,hirsuta,intermedia,jolyi,marcescens,maxillarioides,metzgerae,minima,nanuzae,nivea,obtecta,ornata,patens,peripherica,plicata,resinosa,seubertiana,spiralis,stenocarpa,stipitata,strangii,subscabra,taxifolia,tragacantha,tubiflora,variabilis,variegata)
i<-1
j <- 0
analise <- 0
for (specie in list_specimes){
for (specie2 in list_specimes){
analise[i]<-nicheOverlap(specie,specie2, stat='D', mask=F, checkNegatives=F)
i<-i+1
}
}
matriz <- matrix(analise,nrow = 58,ncol = 58)
matriz
write.table(round(abs(niche.overlap(data.frame(matriz))), 2), "D.xls", row.names = T, sep = "\t")
View(matriz)
write.table(round(abs(niche.overlap(data.frame(matriz))), 8), "D.xls", row.names = T, sep = "\t")
matriz
write.table(round(abs(niche.overlap(data.frame(matriz))), 8), "D2.xls", row.names = T, sep = "\t")
i<-1
j <- 0
analise <- 0
for (specie in list_specimes){
for (specie2 in list_specimes){
analise[i]<-nicheOverlap(specie,specie2, stat='I', mask=F, checkNegatives=F)
i<-i+1
}
}
matriz2 <- matrix(analise,nrow = 58,ncol = 58)
matriz2
View(matriz2)
write.table(round(abs(niche.overlap(data.frame(matriz2))), 8), "I.xls", row.names = T, sep = "\t")
save.image("/Volumes/PAT/Directory/Raster-median/pno.RData")
save.image("/Volumes/PAT/Directory/Raster-median/pno.RData")
library(PresenceAbsence)
library(raster)
library(rgdal)
library(rgeos)
require(rJava)
library(sp)
library(dismo)
library(maptools)
library(usdm)
library(phyloclim)
library(sp)
library(maptools)
library(raster)
library(ape)
library(dismo)
source('myPno.R')
setwd("/Volumes/PAT/Directory/pno")
source('myPno.R')
climvar <- paste(getwd(),'/hotlayers/bio2.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio2 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio2, legend.pos="topright")
plotPNO(tmn.pnobio2, legend.pos= NULL)
tmn.pnobio2
write.table(round(abs(tmn.pnobio2), 2), "pnobio2.xls", row.names = T, sep = "\t")
#bio3
climvar <- paste(getwd(),'/hotlayers/bio3.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio3 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio3, legend.pos= NULL)
write.table(round(abs(tmn.pnobio3), 2), "pnobio3.xls", row.names = T, sep = "\t")
#bio8
climvar <- paste(getwd(),'/hotlayers/bio8.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio8 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio8,legend.pos= NULL)
write.table(round(abs(tmn.pnobio8), 2), "pnobio8.xls", row.names = T, sep = "\t")
#bio9
climvar <- paste(getwd(),'/hotlayers/bio9.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio9 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio9, legend.pos= NULL)
write.table(round(abs(tmn.pnobio9), 2), "pnobio9.xls", row.names = T, sep = "\t")
#bio13
climvar <- paste(getwd(),'/hotlayers/bio13.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio13 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio13,legend.pos= NULL)
write.table(round(abs(tmn.pnobio13), 2), "pnobio13.xls", row.names = T, sep = "\t")
#bio14
climvar <- paste(getwd(),'/hotlayers/bio14.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio14 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio14,legend.pos= NULL)
write.table(round(abs(tmn.pnobio14), 2), "pnobio14.xls", row.names = T, sep = "\t")
#bio15
climvar <- paste(getwd(),'/hotlayers/bio15.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio15 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio15,legend.pos= NULL)
write.table(round(abs(tmn.pnobio15), 2), "pnobio15.xls", row.names = T, sep = "\t")
#bio18
climvar <- paste(getwd(),'/hotlayers/bio18.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio18 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio18,legend.pos= NULL)
write.table(round(abs(tmn.pnobio18), 2), "pnobio18.xls", row.names = T, sep = "\t")
#bio19
climvar <- paste(getwd(),'/hotlayers/bio19.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio19 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(tmn.pnobio19,legend.pos= NULL)
write.table(round(abs(tmn.pnobio19), 2), "pnobio19.xls", row.names = T, sep = "\t")
plotPNO(tmn.pnobio2, legend.pos="topright")
plotPNO(tmn.pnobio2, legend.pos= NULL)
plotPNO(tmn.pnobio3, legend.pos= NULL)
plotPNO(tmn.pnobio8,legend.pos= NULL)
plotPNO(tmn.pnobio9, legend.pos= NULL)
plotPNO(tmn.pnobio13,legend.pos= NULL)
plotPNO(tmn.pnobio14,legend.pos= NULL)
plotPNO(tmn.pnobio15,legend.pos= NULL)
plotPNO(tmn.pnobio18,legend.pos= NULL)
plotPNO(tmn.pnobio19,legend.pos= NULL)
niche.overlap(data.frame(tmn.pnobio13))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio13))), 2), "overlapbio13.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio14))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio14))), 2), "overlapbio14.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio15))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio15))), 2), "overlapbio15.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio18))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio18))), 2), "overlapbio18.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio19))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio19))), 2), "overlapbio19.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio2))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio2))), 2), "overlapbio2.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio3))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio3))), 2), "overlapbio3.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio8))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio8))), 2), "overlapbio8.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(tmn.pnobio9))
write.table(round(abs(niche.overlap(data.frame(tmn.pnobio9))), 2), "overlapbio9.xls", row.names = T, sep = "\t")
View(tmn.pnobio9)
View(tmn.pnobio9)
setwd("/Volumes/PAT/Directory/anc-teste")
####### 5 - ESTIMATION OF ANCESTRAL CLIMATIC
library(ape)
library(phytools)
###import trees:
besttreePP <- read.nexus("bestVellozia-epith", force.multi = FALSE)
library(phytools)
###import trees:
besttreePP <- read.nexus("bestVellozia-epith", force.multi = FALSE)
setwd("/Volumes/PAT/Directory/anc-teste")
###import trees:
besttreePP <- read.nexus("bestVellozia-epith", force.multi = FALSE)
library(ape)
library(phytools)
###import trees:
besttreePP <- read.nexus("bestVellozia-epith", force.multi = FALSE)
multitrees <- read.nexus("Vellozia801trees-epith", force.multi = TRUE)
###import trees:
besttreePP <- read.nexus("bestVellozia-epith", force.multi = FALSE)
plot(besttreePP)
plot(besttreePP)
multitrees <- read.nexus("Vellozia801trees-epith", force.multi = TRUE)
plotTree(multitrees[[300]])
ac<-anc.clim(target = besttreePP, pno = tmn.pnobio2, n=100)
###import trees:
besttreePP <- read.nexus("bestVellozia-epithP", force.multi = FALSE)
plot(besttreePP)
ac<-anc.clim(target = tree, pno = tmn.pnobio2, n=100)
ac<-anc.clim(target = besttreePP, pno = tmn.pnobio2, n=100)
besttreePP$tip.label
tmn.pnobio2
setwd("/Volumes/PAT/Directory/pno")
source('myPno.R')
climvar <- paste(getwd(),'/hotlayers/bio2.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
tmn.pnobio2 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio2, legend.pos="topright")
plotPNO(pnobio2, legend.pos= NULL)
pnobio2
write.table(round(abs(pnobio2), 2), "pnobio2.xls", row.names = T, sep = "\t")
#bio3
climvar <- paste(getwd(),'/hotlayers/bio3.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio3 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio3, legend.pos= NULL)
write.table(round(abs(pnobio3), 2), "pnobio3.xls", row.names = T, sep = "\t")
#bio8
climvar <- paste(getwd(),'/hotlayers/bio8.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio8 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio8,legend.pos= NULL)
write.table(round(abs(pnobio8), 2), "pnobio8.xls", row.names = T, sep = "\t")
#bio9
climvar <- paste(getwd(),'/hotlayers/bio9.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio9 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio9, legend.pos= NULL)
write.table(round(abs(pnobio9), 2), "pnobio9.xls", row.names = T, sep = "\t")
#bio13
climvar <- paste(getwd(),'/hotlayers/bio13.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio13 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio13,legend.pos= NULL)
write.table(round(abs(pnobio13), 2), "pnobio13.xls", row.names = T, sep = "\t")
#bio14
climvar <- paste(getwd(),'/hotlayers/bio14.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio14 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio14,legend.pos= NULL)
write.table(round(abs(pnobio14), 2), "pnobio14.xls", row.names = T, sep = "\t")
#bio15
climvar <- paste(getwd(),'/hotlayers/bio15.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio15 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio15,legend.pos= NULL)
write.table(round(abs(pnobio15), 2), "pnobio15.xls", row.names = T, sep = "\t")
#bio18
climvar <- paste(getwd(),'/hotlayers/bio18.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio18 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio18,legend.pos= NULL)
write.table(round(abs(pnobio18), 2), "pnobio18.xls", row.names = T, sep = "\t")
#bio19
climvar <- paste(getwd(),'/hotlayers/bio19.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio19 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio19,legend.pos= NULL)
write.table(round(abs(pnobio19), 2), "pnobio19.xls", row.names = T, sep = "\t")
setwd("/Volumes/PAT/Directory/anc-teste")
####### 5 - ESTIMATION OF ANCESTRAL CLIMATIC
library(ape)
library(phytools)
###import trees:
besttreePP <- read.nexus("bestVellozia-epithP", force.multi = FALSE)
plot(besttreePP)
ac<-anc.clim(target = tree, pno = pnobio2, n=100)
ac<-anc.clim(target = besttreePP, pno = pnobio2, n=100)
ac<-anc.clim(target = besttreePP, pno = pnobio3, n=100)
save.image("/Volumes/PAT/Directory/anc-teste/Untitled.RData")
View(besttreePP)
####### 5 - ESTIMATION OF ANCESTRAL CLIMATIC
library(ape)
library(phytools)
plot(besttreePP)
View(besttreePP)
besttreePP[["tip.label"]]
setwd("/Volumes/PAT/Directory/anc-teste")
library(phyloclim)
library(sp)
library(maptools)
library(raster)
library(ape)
library(dismo)
source('myPno.R')
## The phyloclim function 'pno' integrates the suitability surface over the climate map to generate a histogram of the relative probability of occupying sites of a given value, along a climate axis. These are equivalent to the plots from Evans et al. 2009 in the lecture. However, I found a missing na.rm in the pno function so it wasn't working on this data set. Load a fix:
source('myPno.R')
#bio2
climvar <- paste(getwd(),'/hotlayers/bio2.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio2 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio2, legend.pos="topright")
plotPNO(pnobio2, legend.pos= NULL)
pnobio2
write.table(round(abs(pnobio2), 2), "pnobio2.xls", row.names = T, sep = "\t")
###import trees:
besttreePP <- read.nexus("bestVellozia-epithP", force.multi = FALSE)
ac<-anc.clim(target = besttreePP, pno = pnobio2, n=100)
climvar <- paste(getwd(),'/hotlayers/bio3.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio3 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio3, legend.pos= NULL)
write.table(round(abs(pnobio3), 2), "pnobio3.xls", row.names = T, sep = "\t")
#bio8
climvar <- paste(getwd(),'/hotlayers/bio8.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio8 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio8,legend.pos= NULL)
write.table(round(abs(pnobio8), 2), "pnobio8.xls", row.names = T, sep = "\t")
#bio9
climvar <- paste(getwd(),'/hotlayers/bio9.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio9 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio9, legend.pos= NULL)
write.table(round(abs(pnobio9), 2), "pnobio9.xls", row.names = T, sep = "\t")
#bio13
climvar <- paste(getwd(),'/hotlayers/bio13.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio13 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio13,legend.pos= NULL)
write.table(round(abs(pnobio13), 2), "pnobio13.xls", row.names = T, sep = "\t")
#bio14
climvar <- paste(getwd(),'/hotlayers/bio14.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio14 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio14,legend.pos= NULL)
write.table(round(abs(pnobio14), 2), "pnobio14.xls", row.names = T, sep = "\t")
#bio15
climvar <- paste(getwd(),'/hotlayers/bio15.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio15 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio15,legend.pos= NULL)
write.table(round(abs(pnobio15), 2), "pnobio15.xls", row.names = T, sep = "\t")
#bio18
climvar <- paste(getwd(),'/hotlayers/bio18.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio18 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio18,legend.pos= NULL)
write.table(round(abs(pnobio18), 2), "pnobio18.xls", row.names = T, sep = "\t")
#bio19
climvar <- paste(getwd(),'/hotlayers/bio19.asc',sep='')
maxent_models <- paste(getwd(),'/outputs/',sep='')
nbins <- 25 # number of histogram bins for climate variable
pnobio19 <- myPno(path_bioclim=climvar,path_model=maxent_models,bin_number=nbins)
plotPNO(pnobio19,legend.pos= NULL)
write.table(round(abs(pnobio19), 2), "pnobio19.xls", row.names = T, sep = "\t")
plotPNO(pnobio2, legend.pos= NULL)
plotPNO(pnobio3, legend.pos= NULL)
plotPNO(pnobio8,legend.pos= NULL)
plotPNO(pnobio9, legend.pos= NULL)
plotPNO(pnobio13,legend.pos= NULL)
plotPNO(pnobio14,legend.pos= NULL)
plotPNO(pnobio15,legend.pos= NULL)
plotPNO(pnobio18,legend.pos= NULL)
plotPNO(pnobio19,legend.pos= NULL)
niche.overlap(data.frame(pnobio13))
write.table(round(abs(niche.overlap(data.frame(pnobio13))), 2), "overlapbio13.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(pnobio14))
write.table(round(abs(niche.overlap(data.frame(pnobio14))), 2), "overlapbio14.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(pnobio15))
write.table(round(abs(niche.overlap(data.frame(pnobio15))), 2), "overlapbio15.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(pnobio18))
write.table(round(abs(niche.overlap(data.frame(pnobio18))), 2), "overlapbio18.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(pnobio19))
write.table(round(abs(niche.overlap(data.frame(pnobio19))), 2), "overlapbio19.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(pnobio2))
write.table(round(abs(niche.overlap(data.frame(pnobio2))), 2), "overlapbio2.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(pnobio3))
write.table(round(abs(niche.overlap(data.frame(pnobio3))), 2), "overlapbio3.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(pnobio8))
write.table(round(abs(niche.overlap(data.frame(pnobio8))), 2), "overlapbio8.xls", row.names = T, sep = "\t")
niche.overlap(data.frame(pnobio9))
write.table(round(abs(niche.overlap(data.frame(pnobio9))), 2), "overlapbio9.xls", row.names = T, sep = "\t")
#read tree
tree<-read.tree('bestVellozia-epithP.txt')
#read tree
tree<-read.tree('bestVellozia-epithP.txt', force.multi = FALSE)
###import trees:
besttreePP <- read.nexus("bestVellozia-epithP", force.multi = FALSE)
ac<-anc.clim(target = besttreePP, pno = pnobio2, n=100)
#read tree
tree<-read.tree('VellPattreefile.txt')
ac<-anc.clim(target = tree, pno = pnobio2, n=100)
save.image("/Volumes/PAT/Directory/anc-teste/Untitled.RData")
plotPNO(pnobio2, legend.pos= NULL)
plotPNO(pnobio3, legend.pos= NULL)
plotPNO(pnobio8,legend.pos= NULL)
plotPNO(pnobio9, legend.pos= NULL)
plotPNO(pnobio13,legend.pos= NULL)
plotPNO(pnobio14,legend.pos= NULL)
plotPNO(pnobio15,legend.pos= NULL)
plotPNO(pnobio18,legend.pos= NULL)
plotPNO(pnobio19,legend.pos= NULL)
save.image("/Volumes/PAT/Directory/anc-teste/Untitled.RData")
